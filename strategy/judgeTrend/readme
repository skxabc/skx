# 市场趋势判断系统

## 功能说明

本系统用于判断A股和港股市场当前是处于**上升趋势**、**震荡**还是**下降趋势**，帮助根据不同市场状态运用不同策略：
- **上升趋势**：使用上升追踪策略
- **震荡市场**：使用震荡策略
- **下降趋势**：空仓等待

## 系统特点

1. **多市场支持**：支持A股和港股市场分析
2. **多指数综合判断**：
   - A股：上证指数、深证成指、创业板指、沪深300
   - 港股：恒生指数、恒生国企指数、恒生科技指数
3. **多技术指标**：
   - 移动平均线（MA）：20日均线、60日均线
   - MACD：判断趋势强度和转折点
   - RSI：判断超买超卖
   - 布林带：判断波动性和价格位置
   - 价格动量：短期和中期价格变化
4. **综合评分**：多个指标加权综合，给出趋势判断和置信度

## 安装依赖

```bash
pip install -r requirements.txt
```

## 数据源配置（重要！）

**强烈推荐使用Tushare数据源以获得更稳定的数据**，详见 [数据源说明.md](数据源说明.md)

### Tushare Token配置

**当前已配置Token：** `e3b0c217382e04e27a45598399d6fb4d7acae60b3373a661b03d64f7`

**注意：** Tushare免费版可能没有指数日线数据（index_daily）接口权限，系统会自动降级使用备用数据源。

使用方式：
```bash
python3 main.py --market all --tushare-token e3b0c217382e04e27a45598399d6fb4d7acae60b3373a661b03d64f7
```

或设置环境变量：
```bash
export TUSHARE_TOKEN=e3b0c217382e04e27a45598399d6fb4d7acae60b3373a661b03d64f7
python3 main.py --market all
```

### 当前数据源状态

⚠️ **当前所有数据源都遇到问题：**
- Tushare免费版：缺少指数数据接口权限
- akshare：网络连接不稳定
- yfinance：请求过于频繁被限流

**建议解决方案：**
1. **等待一段时间后重试**（网络问题可能是临时的）
2. **升级Tushare到付费版**（如果有指数数据需求）
3. **使用其他数据源**（如聚宽、米筐等）
4. **检查网络连接**，确保可以访问数据源服务器

## 使用方法

### 1. 使用Tushare数据源（推荐，最稳定）

```bash
# 方式1：通过命令行参数
python3 main.py --market all --tushare-token YOUR_TOKEN

# 方式2：通过环境变量
export TUSHARE_TOKEN=YOUR_TOKEN
python3 main.py --market all
```

### 2. 使用免费数据源（可能不稳定）

```bash
# 分析所有市场（A股+港股）
python3 main.py --market all

# 只分析A股市场
python3 main.py --market A

# 只分析港股市场
python3 main.py --market H
```

### 3. 保存结果到文件

```bash
python3 main.py --market all --output result.json
```

## 输出说明

系统会输出以下信息：

1. **各指数分析结果**：
   - 趋势类型（上升/下降/震荡）
   - 置信度
   - 当前价格和关键指标值
   - 各技术指标信号强度

2. **市场整体判断**：
   - 市场整体趋势
   - 趋势强度（-1到1之间）
   - 综合置信度

3. **策略建议**：
   - 根据趋势类型给出相应的策略建议

## 趋势判断逻辑

系统使用加权综合评分来判断趋势：

- **上升趋势**：综合评分 > 0.3
- **下降趋势**：综合评分 < -0.3
- **震荡市场**：-0.3 ≤ 综合评分 ≤ 0.3

各指标权重：
- 移动平均线（MA）：30%
- MACD：25%
- 价格动量：20%
- RSI：15%
- 布林带：10%

## 文件说明

- `market_data.py`：市场数据获取模块，负责从数据源获取指数K线数据
- `trend_judge.py`：趋势判断核心模块，包含所有技术指标计算和趋势判断逻辑
- `main.py`：主程序入口，提供命令行接口
- `requirements.txt`：Python依赖包列表

## 注意事项

1. 数据获取依赖网络连接，首次运行可能需要一些时间
2. 如果某个指数数据获取失败，系统会跳过该指数继续分析其他指数
3. 建议在交易时间外运行，避免数据更新延迟
4. 趋势判断仅供参考，不构成投资建议
